# WebGL (web graohics library)
- 历史背景
  - 起始于2006年 一位 Mozilla 员工弗拉基米尔·弗基西维奇的一项 Canvas 3D 实验项目
  - 2011 年 3 月 WebGL 1.0 规范发布
  - 2017 年 1 月 WebGL 2.0 规范发布
- 定义
  - 仅仅是一个光栅化引擎，可以根据你的GLSL代码绘制出 点 线 三角形。更复杂的任务，取决于GLSL代码组合使用 点 线 三角形代替实现
  - 在电脑的GPU中运行，因此使用一种类C和C++的强类型语言 GLSL（GL着色语言）
  - GLSL 语言需要提供成对的方法，每对方法中 一个叫 顶点着色器，一个叫 片段着色器，每一对连接起来称作 着色程序。
- 本质
    - 一种开发 3D 网页的绘图技术，JavaScript 提供了 API
    - 基于 Canvas 画布进行绘制（提供渲染上下文）

- 作用

    - 在浏览器中渲染交互式的 3D 图形 （兼容的）(无需插件)

    - 使开发者可以利用 GPU 加速处理，在网页上实现复杂图形效果

- 特点

  - 基于 OpenGL ES 2.0/3.0 (免费的跨平台 3D 图形 API 接口 | 嵌入式设备 | 移动设备)

- 应用场景

  - 网页上开发高性能 3D 游戏

## WebGL 坐标系

- 右手坐标系

- X,Y,Z 轴正方向最大值为 1 ，负方向最大值为 -1

![WebGL 坐标系](../assets/WebGL坐标系.png)

## Canvas 坐标系

> Canvas 画布 支持 2D 与 3D 坐标系

- 2D 坐标轴
    - 坐标原点：画布左顶点
    - x轴：水平方向向右
    - y轴：垂直方向向下 
![canvas-2D-坐标系](../assets/canvas-2D-%E5%9D%90%E6%A0%87%E7%B3%BB.PNG)
- 3D 坐标轴
    - 坐标原点：画布中心
    - x轴：水平方向
    - y轴：垂直方向
    - z轴：屏幕朝外方向
![canvas-3D-坐标系](../assets/canvas-3D-%E5%9D%90%E6%A0%87%E7%B3%BB.PNG)

## WebGL API

> 几乎整个 WebGL API 都是 关于如何设置 这些 成对方法（顶点着色器|片段着色器）的状态值 和 运行它们的

## 顶点着色器

- 为什么用
  - 有这些顶点位置 webGL 才可以对 点， 线和三角形等图元进行光栅化处理

- 作用
  - 计算顶点位置
  - 提供顶点在裁剪空间中的坐标值

## 片段着色器

- 为什么用
  - 对图元进行光栅化处理时，需要用到片段着色器方法

- 作用
  - 计算出当前绘制图元中每个像素的颜色值


## WebGL 渲染管线

- 定义
  - 将 3D 场景转换为 2D 图像，最终通过GPU加速在屏幕上显示出来的一系列任务流程
- 核心目的
  - 把3D世界像拍照片一样，又快又好地变成手机/电脑屏幕上的2D画面
  - 举例
    - 你搭了个乐高城市（3D模型）
    - 用手机拍照（顶点着色器处理位置）
    - 加滤镜调颜色（片元着色器处理像素）
    - 自动修图（深度测试、混合等处理）
    - 发朋友圈（输出到屏幕）
- 组成
  - 顶点处理
    - 顶点着色器处理每个顶点的数据，将顶点坐标从对象空间转换到裁剪空间
  - 图元装配
    - 顶点被组合成图元（例如三角形/线段/点）。WebGL支持的基本图元类型包括点/线段和三角形
  - 光栅化
    - 将图元转换为片段（fragments）,每个片段对应一个屏幕像素。光栅化过程确定哪些像素被图元覆盖，并生成这些片段的插值属性（如颜色/深度/纹理坐标）。
  - 片段处理
    - 片段着色器对每个片段执行操作，确定其最终颜色。片段着色器确定其最终颜色。片段着色器可以执行光照计算/纹理采样和颜色混合等操作
  - 测试阶段
    - 深度测试
      - 确定片段是否在当前帧缓冲区的深度范围内，以决定是否绘制该片段
    - 模板测试
      - 使用模板缓冲区进行进一步的片段筛选。
  - 融合阶段
    - 将片段颜色与帧缓冲区中已有颜色混合，以实现透明效果等。
  - 帧缓冲操作
    - 最终的片段颜色被写入帧缓冲区，准备显示在屏幕上。帧缓冲区是一个存储颜色/深度和模板信息的内存区域


- 名词解释
  - 顶点着色器
  - 对象空间
  - 裁剪空间
  - 光栅化处理